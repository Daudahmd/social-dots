{% load static %}
<!-- Testimonials Section -->
<section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold mb-4 text-deepBlue">What Clients Say About Us</h2>
            <p class="text-lg text-muted-foreground max-w-3xl mx-auto">Don't just take our word for it. Here's what our clients have to say about working with us.</p>
            <div class="w-24 h-1 bg-gold mx-auto mt-6 rounded-full"></div>
        </div>
        
        <!-- Swiper CSS -->
        <style>
            .swiper {
                width: 100%;
                padding-bottom: 50px;
            }
            .swiper-slide {
                height: auto;
                transition: transform 0.3s;
            }
            .swiper-pagination-bullet-active {
                background-color: #DDA853;
            }
            .swiper-button-next, .swiper-button-prev {
                color: #183B4E;
            }
            .swiper-button-next:hover, .swiper-button-prev:hover {
                color: #DDA853;
            }
        </style>
        
        <!-- Swiper Container -->
        <div class="swiper testimonials-swiper">
            <div class="swiper-wrapper">
                {% for testimonial in testimonials %}
                <div class="swiper-slide">
                    <div class="bg-white rounded-xl p-8 shadow-md hover:shadow-xl transition-all duration-300 border border-gold/10 h-full">
                        <div class="flex items-center mb-6">
                            <div class="flex-shrink-0 mr-4">
                                {% if testimonial.client_image %}
                                <img src="{{ testimonial.client_image }}" alt="{{ testimonial.client_name }}" class="w-16 h-16 rounded-full" />
                                {% else %}
                                <img src="{% static 'images/testimonials/avatar1.svg' %}" alt="{{ testimonial.client_name }}" class="w-16 h-16 rounded-full" />
                                {% endif %}
                            </div>
                            <div>
                                <h4 class="text-lg font-semibold">{{ testimonial.client_name }}</h4>
                                <p class="text-sm text-muted-foreground">
                                    {% if testimonial.client_position %}{{ testimonial.client_position }}{% endif %}
                                    {% if testimonial.client_position and testimonial.client_company %}, {% endif %}
                                    {% if testimonial.client_company %}{{ testimonial.client_company }}{% endif %}
                                </p>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <div class="flex text-gold mb-2">
                                {% for i in "12345"|make_list %}
                                    {% if forloop.counter <= testimonial.rating %}
                                    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                    </svg>
                                    {% else %}
                                    <svg class="w-5 h-5 text-gray-300" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                    </svg>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <p class="italic text-muted-foreground">"{{ testimonial.content }}"</p>
                        </div>
                        
                        {% comment %} <div class="text-right">
                            <a href="/about/" class="text-navy text-sm hover:text-gold transition-colors">Read full story →</a>
                        </div> {% endcomment %}
                    </div>
                </div>
                {% empty %}
                <!-- Fallback testimonial if no testimonials in database -->
                <div class="swiper-slide">
                    <div class="bg-white rounded-xl p-8 shadow-md hover:shadow-xl transition-all duration-300 border border-gold/10 h-full">
                        <div class="flex items-center mb-6">
                            <div class="flex-shrink-0 mr-4">
                                <img src="{% static 'images/testimonials/avatar1.svg' %}" alt="Sample Client" class="w-16 h-16 rounded-full" />
                            </div>
                            <div>
                                <h4 class="text-lg font-semibold">Sample Client</h4>
                                <p class="text-sm text-muted-foreground">CEO, Sample Company</p>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <div class="flex text-gold mb-2">
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                </svg>
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                </svg>
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                </svg>
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                </svg>
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                                </svg>
                            </div>
                            <p class="italic text-muted-foreground">"Add testimonials through the admin panel to display real client feedback here."</p>
                        </div>
                        
                        <div class="text-right">
                            <a href="/about/" class="text-navy text-sm hover:text-gold transition-colors">Read full story →</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Add Swiper navigation -->
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            
            <!-- Add Swiper pagination -->
            <div class="swiper-pagination"></div>
        </div>
        
        <!-- Swiper JS Initialization -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Check if Swiper is loaded
                if (typeof Swiper === 'undefined') {
                    // Load Swiper from CDN if not available
                    var swiperScript = document.createElement('script');
                    swiperScript.src = 'https://unpkg.com/swiper/swiper-bundle.min.js';
                    swiperScript.onload = initSwiper;
                    document.head.appendChild(swiperScript);
                    
                    var swiperStyle = document.createElement('link');
                    swiperStyle.rel = 'stylesheet';
                    swiperStyle.href = 'https://unpkg.com/swiper/swiper-bundle.min.css';
                    document.head.appendChild(swiperStyle);
                } else {
                    initSwiper();
                }
                
                function initSwiper() {
                    new Swiper('.testimonials-swiper', {
                        slidesPerView: 1,
                        spaceBetween: 30,
                        loop: true,
                        autoplay: {
                            delay: 5000,
                            disableOnInteraction: false,
                        },
                        pagination: {
                            el: '.swiper-pagination',
                            clickable: true,
                        },
                        navigation: {
                            nextEl: '.swiper-button-next',
                            prevEl: '.swiper-button-prev',
                        },
                        breakpoints: {
                            640: {
                                slidesPerView: 1,
                                spaceBetween: 20,
                            },
                            768: {
                                slidesPerView: 2,
                                spaceBetween: 30,
                            },
                            1024: {
                                slidesPerView: 3,
                                spaceBetween: 30,
                            },
                        },
                    });
                }
            });
        </script>
    
    </div>
</section>